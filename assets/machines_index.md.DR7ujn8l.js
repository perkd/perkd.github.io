import{_ as a,c as i,o as e,ag as n}from"./chunks/framework.Cycwnjj0.js";const k=JSON.parse('{"title":"Machine APIs","description":"","frontmatter":{},"headers":[],"relativePath":"machines/index.md","filePath":"machines/index.md"}'),t={name:"machines/index.md"};function l(p,s,h,o,r,d){return e(),i("div",null,[...s[0]||(s[0]=[n(`<h1 id="machine-apis" tabindex="-1">Machine APIs <a class="header-anchor" href="#machine-apis" aria-label="Permalink to &quot;Machine APIs&quot;">â€‹</a></h1><p>The Perkd Machine API enables vending machines and kiosks to accept payments and process orders through the Perkd digital wallet app.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">â€‹</a></h2><p>Machine APIs use an <strong>Action-based model</strong>:</p><ol><li>Your machine <strong>generates an Action QR code</strong> via API</li><li>Customer <strong>scans the QR</strong> with Perkd app</li><li>Customer <strong>completes the action</strong> in the app</li><li>Perkd <strong>sends result to your callback endpoint</strong></li></ol><h2 id="supported-machines" tabindex="-1">Supported Machines <a class="header-anchor" href="#supported-machines" aria-label="Permalink to &quot;Supported Machines&quot;">â€‹</a></h2><h3 id="vending-machines" tabindex="-1">Vending Machines <a class="header-anchor" href="#vending-machines" aria-label="Permalink to &quot;Vending Machines&quot;">â€‹</a></h3><p>Full feature set for unattended vending:</p><table tabindex="0"><thead><tr><th>Action</th><th>Purpose</th><th>Use Case</th></tr></thead><tbody><tr><td><a href="/machines/vending/checkin.html"><strong>Check In</strong></a></td><td>Identify customer, show pickups</td><td>Member recognition, pre-orders</td></tr><tr><td><a href="/machines/vending/order.html"><strong>Order</strong></a></td><td>Create purchase order</td><td>On-site product selection</td></tr><tr><td><a href="/machines/vending/pickup.html"><strong>Pickup</strong></a></td><td>Dispense items</td><td>Sample redemption, pre-paid orders</td></tr><tr><td><a href="/machines/vending/pay.html"><strong>Pay</strong></a></td><td>Collect payment</td><td>Parking, services, deposits</td></tr></tbody></table><h3 id="kiosks" tabindex="-1">Kiosks <a class="header-anchor" href="#kiosks" aria-label="Permalink to &quot;Kiosks&quot;">â€‹</a></h3><p>Simplified ordering for self-service kiosks:</p><table tabindex="0"><thead><tr><th>Action</th><th>Purpose</th><th>Use Case</th></tr></thead><tbody><tr><td><a href="/machines/kiosk/order.html"><strong>Order</strong></a></td><td>Create purchase order</td><td>Self-checkout, food ordering</td></tr></tbody></table><h2 id="action-flow" tabindex="-1">Action Flow <a class="header-anchor" href="#action-flow" aria-label="Permalink to &quot;Action Flow&quot;">â€‹</a></h2><div class="language-mermaid vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    participant M as Machine</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    participant P as Perkd API</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    participant C as Customer App</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    participant CB as Your Callback</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    M-&gt;&gt;P: POST /Actions/{type}&lt;br/&gt;(generate QR)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    P--&gt;&gt;M: Return action URI</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    M-&gt;&gt;M: Display QR code</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    C-&gt;&gt;C: Scan QR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    C-&gt;&gt;P: Complete action</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    P-&gt;&gt;CB: POST callback</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    CB--&gt;&gt;P: 200 OK</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    M-&gt;&gt;M: Dispense/complete</span></span></code></pre></div><h2 id="quick-start" tabindex="-1">Quick Start <a class="header-anchor" href="#quick-start" aria-label="Permalink to &quot;Quick Start&quot;">â€‹</a></h2><h3 id="_1-generate-action-qr" tabindex="-1">1. Generate Action QR <a class="header-anchor" href="#_1-generate-action-qr" aria-label="Permalink to &quot;1. Generate Action QR&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">POST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://api.perkd.io/prod/Actions/vending</span></span></code></pre></div><p><strong>Headers:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>x-api-key: YOUR_API_KEY</span></span>
<span class="line"><span>Content-Type: application/json</span></span></code></pre></div><p><strong>Body:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;order&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;machineId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;machine-001&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;items&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;title&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Coke&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;sku&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;COLA_COKE01&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;unitPrice&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;quantity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;inventory&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;images&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com/coke.jpg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;referenceId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;order-12345&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>Response:</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;uri&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://app.perkd.me/64633389e1788b003a234a3b?p=AlTJD...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_2-display-qr-code" tabindex="-1">2. Display QR Code <a class="header-anchor" href="#_2-display-qr-code" aria-label="Permalink to &quot;2. Display QR Code&quot;">â€‹</a></h3><p>Encode the <code>uri</code> as a QR code for customers to scan.</p><h3 id="_3-receive-callback" tabindex="-1">3. Receive Callback <a class="header-anchor" href="#_3-receive-callback" aria-label="Permalink to &quot;3. Receive Callback&quot;">â€‹</a></h3><p>Your callback endpoint receives the result:</p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">POST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> https://yourdomain.com/perkd/order/machine-001</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Content-Type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> application/json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;items&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;referenceId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;order-12345&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Return <code>200 OK</code> to acknowledge receipt.</p><h2 id="endpoints" tabindex="-1">Endpoints <a class="header-anchor" href="#endpoints" aria-label="Permalink to &quot;Endpoints&quot;">â€‹</a></h2><h3 id="base-urls" tabindex="-1">Base URLs <a class="header-anchor" href="#base-urls" aria-label="Permalink to &quot;Base URLs&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>Environment</th><th>URL</th></tr></thead><tbody><tr><td>Test</td><td><code>https://api.perkd.io/test</code></td></tr><tr><td>Production</td><td><code>https://api.perkd.io/prod</code></td></tr></tbody></table><h3 id="action-generation" tabindex="-1">Action Generation <a class="header-anchor" href="#action-generation" aria-label="Permalink to &quot;Action Generation&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>POST /Actions/vending    # Vending machine actions</span></span>
<span class="line"><span>POST /Actions/kiosk      # Kiosk actions</span></span></code></pre></div><h3 id="payment-management" tabindex="-1">Payment Management <a class="header-anchor" href="#payment-management" aria-label="Permalink to &quot;Payment Management&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>POST /Pay/commit         # Capture authorized payment</span></span>
<span class="line"><span>POST /Pay/cancel         # Cancel authorized payment</span></span></code></pre></div><h3 id="callbacks-your-endpoints" tabindex="-1">Callbacks (Your Endpoints) <a class="header-anchor" href="#callbacks-your-endpoints" aria-label="Permalink to &quot;Callbacks (Your Endpoints)&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>POST {your_url}/perkd/checkin/{machineId}</span></span>
<span class="line"><span>POST {your_url}/perkd/order/{machineId}</span></span>
<span class="line"><span>POST {your_url}/perkd/pickup/{machineId}</span></span>
<span class="line"><span>POST {your_url}/perkd/pay/{machineId}</span></span>
<span class="line"><span>POST {your_url}/perkd/authorize/{machineId}</span></span>
<span class="line"><span>POST {your_url}/perkd/reserve/{machineId}</span></span></code></pre></div><h2 id="common-parameters" tabindex="-1">Common Parameters <a class="header-anchor" href="#common-parameters" aria-label="Permalink to &quot;Common Parameters&quot;">â€‹</a></h2><h3 id="machine-identification" tabindex="-1">Machine Identification <a class="header-anchor" href="#machine-identification" aria-label="Permalink to &quot;Machine Identification&quot;">â€‹</a></h3><p>All actions require a unique <code>machineId</code>:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;machineId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vm-hq-floor1-a&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">Machine ID Best Practices</p><ul><li>Use consistent naming (e.g., <code>{type}-{location}-{identifier}</code>)</li><li>Keep them URL-safe (alphanumeric + hyphens)</li><li>Make them globally unique across all your machines</li></ul></div><h3 id="reference-id" tabindex="-1">Reference ID <a class="header-anchor" href="#reference-id" aria-label="Permalink to &quot;Reference ID&quot;">â€‹</a></h3><p>Optional identifier to track requests:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;referenceId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;session-001&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Use this to:</p><ul><li>Match callbacks to requests</li><li>Track transactions</li><li>Debug issues</li><li>Implement idempotency</li></ul><h2 id="response-format" tabindex="-1">Response Format <a class="header-anchor" href="#response-format" aria-label="Permalink to &quot;Response Format&quot;">â€‹</a></h2><h3 id="success-response" tabindex="-1">Success Response <a class="header-anchor" href="#success-response" aria-label="Permalink to &quot;Success Response&quot;">â€‹</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;uri&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://app.perkd.me/123?p=encrypted_params&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>The <code>uri</code> contains an action link that can be:</p><ul><li>Encoded as QR code</li><li>Embedded in NFC tag</li><li>Sent as deep link</li></ul><h3 id="error-response" tabindex="-1">Error Response <a class="header-anchor" href="#error-response" aria-label="Permalink to &quot;Error Response&quot;">â€‹</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;InvalidRequest&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Missing required field: machineId&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="action-validity" tabindex="-1">Action Validity <a class="header-anchor" href="#action-validity" aria-label="Permalink to &quot;Action Validity&quot;">â€‹</a></h2><p>Generated action URIs are valid for <strong>1 hour</strong> by default.</p><p>After expiration:</p><ul><li>QR codes cannot be scanned</li><li>App shows &quot;expired&quot; message</li><li>Generate a new action QR</li></ul><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">â€‹</a></h2><div class="tip custom-block"><p class="custom-block-title">ðŸŽ¯ Choose Your Path</p><p><strong>By Machine Type:</strong></p><ul><li><a href="/machines/vending/checkin.html">Vending Machine APIs</a></li><li><a href="/machines/kiosk/order.html">Kiosk APIs</a></li></ul><p><strong>By Feature:</strong></p><ul><li><a href="/machines/callbacks/">Callbacks Overview</a></li><li><a href="/machines/payment/">Payment Management</a></li><li><a href="/schemas/">Data Schemas</a></li></ul></div>`,61)])])}const u=a(t,[["render",l]]);export{k as __pageData,u as default};
